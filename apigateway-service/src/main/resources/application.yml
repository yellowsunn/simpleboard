spring:
  profiles:
    default: local
  cloud:
    gateway:
      globalcors:
        cors-configurations:
          '[/api/**]':
            allowed-origins: "*"
            allowed-headers: "*"
            allowed-methods: "*"
      routes:
        - id: image-proxy
          uri: ${endpoint.image-service}
          predicates:
            - Path=/images/**
            - Method=GET, OPTIONS
          filters:
            - RemoveRequestHeader=Cookie
        - id: image-upload
          uri: ${endpoint.image-service}
          predicates:
            - Path=/api/images/*
            - Method=POST, OPTIONS
          filters:
            - RemoveRequestHeader=Cookie
            - AuthorizationHeaderFilter
        - id: oauth2-link-complete
          uri: ${endpoint.user-service}
          predicates:
            - Path=/api/v2/auth/oauth2/link
            - Method=PUT, DELETE, OPTIONS
          filters:
            - RemoveRequestHeader=Cookie
            - AuthorizationHeaderFilter
        - id: user-auth
          uri: ${endpoint.user-service}
          predicates:
            - Path=/api/v2/auth/**
            - Method=POST, PUT, DELETE, OPTIONS
          filters:
            - RemoveRequestHeader=Cookie
        - id: user-service
          uri: ${endpoint.user-service}
          predicates:
            - Path=/api/v2/users/**
            - Method=GET, POST, PUT, PATCH, DELETE, OPTIONS
          filters:
            - RemoveRequestHeader=Cookie
            - AuthorizationHeaderFilter
        - id: board-service
          uri: ${endpoint.board-service}
          predicates:
            - Method=GET, POST, PUT, PATCH, DELETE, OPTIONS
            - Path=/api/v2/articles/**, /api/v2/comments/**
          filters:
            - RemoveRequestHeader=Cookie
            - AuthorizationHeaderFilter
---
server:
  port: 8000
spring:
  profiles:
    active: local

endpoint:
  user-service: http://localhost:8080
  board-service: http://localhost:8081
  image-service: http://localhost:8082

token:
  access:
    secret: jekmrsrhPKOwSUnR7m8WtcWv_K5SdKygftw3x99BrCs
